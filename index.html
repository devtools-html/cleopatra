<!DOCTYPE html>
<html>
  <head>
    <title>Cleopatra - UI for SPS</title>
    <script src="js/parser.js"></script>
    <script src="js/tree.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/QueryData.compressed.js"></script>
    <link rel="stylesheet" type="text/css" href="css/ui.css">
    <link rel="stylesheet" type="text/css" href="css/tree.css">
  </head>
  <body>
    <menu id="xulContextMenu" type="context">
      <!-- Items are added/removed each time the menu is shown -->
    </menu>
    <div id="ui" class="hidden">
      <div id="mainarea">
        <div id="tree"></div>
        <div id="bottombar">
          <div id="histogram"></div>
          <div id="markers"></div>
          <div class="histogramHilite collapsed">
          </div>
        </div>
      </div>
      <ul id="fileList">
        <li class="fileListItem">
          <span class="fileListItemTitle">Current Profile</span>
          <span class="fileListItemDescription"><a id="fileListItemSamples">...</a> Samples, 2012-03-08 22:12</span>
        </li>
      </ul>
      <div id="infobar"></div>
    </div>
    <div id="dataentry">
      <h1>Upload your profile here:</h1>
      <input type="file" id="datafile" onchange="loadProfileFile(this.files);">
      <h1>Or, alternatively, enter your profile data here:</h1>
      <textarea rows=20 cols=80 id=data autofocus spellcheck=false></textarea>
      <p><button onclick="loadProfile(document.getElementById('data').value); enterMainUI();">Parse</button></p>
    </div>
    <script>
      if (location.href.indexOf("usesample") != -1) {
        var filename = (location.href.indexOf("pseudo") != -1) ? 'sample.profile' : 'sample.log';
        var oXHR = new XMLHttpRequest();
        oXHR.open('GET', filename, true);
        oXHR.responseType = "text";
        oXHR.onreadystatechange = function (oEvent) {  
          if (oXHR.readyState === 4) {  
            if (oXHR.status === 200) {  
              loadProfile(oXHR.responseText);
              enterMainUI();
            } else {  
              alert("Using the sample log needs XHR to work, so you can't run this from a file URL but need to start a webserver.");
            }  
          }  
        };  
        oXHR.send(null);
      }
      function xulContextMenu(event) {
        console.log(event.target);
        alert(event.target);
      }
    </script>
  </body>
</html>
